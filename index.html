<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Capacitaci√≥n Docente UGEL Huari</title>
    <style>
        /* (Los estilos anteriores permanecen igual) */
        
        /* Nuevos estilos para sesiones completadas */
        .completed-session {
            text-decoration: line-through;
            color: #888888;
            background-color: #f0f0f0 !important;
        }
        
        .completed-session td {
            color: #888888;
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
    <!-- (El HTML anterior permanece igual hasta la parte del script) -->

    <script>
        // ============== CONFIGURACI√ìN INICIAL ==============
        
        // Configuraci√≥n de zona horaria (Per√∫)
        const timeZone = 'America/Lima';
        
        // Datos del cronograma COMPLETO
        const scheduleData = [
            { 
                date: '11/06/2025', 
                time: '15:00', 
                topic: 'Uso pedag√≥gico de Canva en la creaci√≥n de presentaciones de audio y video con IA para dinamizar las sesiones de aprendizaje',
                level: 'Primaria/Secundaria',
                current: true, // Sesi√≥n 5 actual
                completed: false
            },
            { 
                date: '18/06/2025', 
                time: '15:00', 
                topic: 'Uso pedag√≥gico de la herramienta de inteligencia artificial (IA) prompts para el desarrollo de las competencias comunicativas',
                level: 'Primaria/Secundaria',
                completed: false
            },
            { 
                date: '25/06/2025', 
                time: '15:00', 
                topic: 'Uso pedag√≥gico de la APP Octostudio para producci√≥n de textos',
                level: 'Primaria/Secundaria',
                completed: false
            },
            { 
                date: '02/07/2025', 
                time: '15:00', 
                topic: 'Uso pedag√≥gico de Rodocodo y Octostudio para el logro de competencias comunicativas',
                level: 'Primaria/Secundaria',
                completed: false
            },
            { 
                date: '09/07/2025', 
                time: '15:00', 
                topic: 'Uso pedag√≥gico de Khanmigo para crear actividades orientadas al desarrollo de los aprendizajes de los estudiantes',
                level: 'Primaria/Secundaria',
                completed: false
            },
            { 
                date: '15/07/2025', 
                time: '15:00', 
                topic: 'Taller sobre Scratch: Programaci√≥n creativa para el desarrollo del pensamiento computacional',
                level: 'Primaria/Secundaria',
                completed: false
            }
        ];
        
        // (Las funciones anteriores permanecen igual hasta generateScheduleTable)
        
        /**
         * Genera la tabla de horarios din√°micamente
         */
        function generateScheduleTable() {
            scheduleTable.innerHTML = '';
            
            scheduleData.forEach((event, index) => {
                const row = document.createElement('tr');
                
                // Marcar sesi√≥n actual
                if (event.current) {
                    row.classList.add('current-event');
                }
                
                // Marcar sesiones completadas
                if (event.completed) {
                    row.classList.add('completed-session');
                }
                
                // Numeraci√≥n de sesiones (5-10)
                row.innerHTML = `
                    <td>${index + 5}</td>
                    <td>${event.date}</td>
                    <td>${event.time}</td>
                    <td>${event.topic}</td>
                    <td>${event.level}</td>
                `;
                
                scheduleTable.appendChild(row);
            });
        }
        
        /**
         * Inicializa el contador regresivo para el evento actual
         */
        function initCountdown() {
            // Limpiar intervalos y timeouts anteriores
            clearInterval(countdownInterval);
            clearTimeout(resetTimeout);
            
            // Encontrar la pr√≥xima sesi√≥n no completada
            currentEventIndex = scheduleData.findIndex(event => !event.completed && !event.current);
            
            // Si no hay m√°s eventos o el actual es el √∫ltimo
            if (currentEventIndex === -1) {
                currentEventIndex = scheduleData.length - 1;
            }
            
            // Si hemos pasado todos los eventos
            if (currentEventIndex >= scheduleData.length || scheduleData.every(event => event.completed)) {
                currentEventDateEl.textContent = "¬°Todas las sesiones de capacitaci√≥n han concluido!";
                countdownContainer.style.display = 'none';
                messageEl.style.display = 'none';
                finalMessageEl.style.display = 'block';
                return;
            }
            
            const currentEvent = scheduleData[currentEventIndex];
            targetDate = new Date(`${currentEvent.date.split('/').reverse().join('-')}T${currentEvent.time}:00-05:00`);
            
            // Validar fecha
            if (isNaN(targetDate.getTime())) {
                console.error('Fecha inv√°lida:', currentEvent.date, currentEvent.time);
                return;
            }
            
            // Actualizar texto del evento actual
            currentEventDateEl.innerHTML = `üóìÔ∏è Sesi√≥n ${currentEventIndex + 5}: ${currentEvent.date} - üïí ${currentEvent.time} horas | ${currentEvent.topic}`;
            
            // Actualizar clases en la tabla
            updateTableStyles();
            
            // Asegurarse de que los elementos de cuenta regresiva son visibles
            countdownContainer.style.display = 'flex';
            messageEl.style.display = 'none';
            finalMessageEl.style.display = 'none';
            isEventInProgress = false;
            
            // Iniciar el contador
            updateCountdown();
            countdownInterval = setInterval(updateCountdown, 1000);
        }
        
        /**
         * Actualiza los estilos de la tabla
         */
        function updateTableStyles() {
            const rows = scheduleTable.querySelectorAll('tr');
            rows.forEach((row, index) => {
                row.classList.remove('current-event', 'in-progress');
                
                // Marcar sesi√≥n actual
                if (index === currentEventIndex) {
                    row.classList.add('current-event');
                }
                
                // Marcar sesiones completadas
                if (scheduleData[index].completed) {
                    row.classList.add('completed-session');
                }
            });
        }
        
        /**
         * Actualiza el contador regresivo
         */
        function updateCountdown() {
            const now = new Date();
            const distance = targetDate - now;
            
            // Calcular d√≠as, horas, minutos y segundos
            const days = Math.max(0, Math.floor(distance / (1000 * 60 * 60 * 24)));
            const hours = Math.max(0, Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60)));
            const minutes = Math.max(0, Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60)));
            const seconds = Math.max(0, Math.floor((distance % (1000 * 60)) / 1000));
            
            // Actualizar el DOM
            daysEl.textContent = days.toString().padStart(2, '0');
            hoursEl.textContent = hours.toString().padStart(2, '0');
            minutesEl.textContent = minutes.toString().padStart(2, '0');
            secondsEl.textContent = seconds.toString().padStart(2, '0');
            
            // Cambiar colores seg√∫n el tiempo restante
            const countdownBoxes = document.querySelectorAll('.countdown-box');
            
            if (distance < 3600000) { // Menos de 1 hora
                countdownBoxes.forEach(box => {
                    box.style.background = 'linear-gradient(145deg, var(--danger-color), #ff6b6b)';
                });
            } else if (distance < 86400000) { // Menos de 1 d√≠a
                countdownBoxes.forEach(box => {
                    box.style.background = 'linear-gradient(145deg, var(--warning-color), #ffb347)';
                });
            } else {
                // Volver a colores originales
                countdownBoxes.forEach(box => {
                    box.style.background = 'linear-gradient(145deg, #3a1a7a, #4a2a98)';
                });
            }
            
            // Manejar cuando el evento ha comenzado
            if (distance < 0 && !isEventInProgress) {
                isEventInProgress = true;
                clearInterval(countdownInterval);
                messageEl.style.display = 'block';
                countdownContainer.style.display = 'none';
                
                // Mostrar 00:00:00:00
                daysEl.textContent = '00';
                hoursEl.textContent = '00';
                minutesEl.textContent = '00';
                secondsEl.textContent = '00';
                
                // Marcar evento en progreso en la tabla
                const rows = scheduleTable.querySelectorAll('tr');
                if (currentEventIndex < rows.length) {
                    rows[currentEventIndex].classList.remove('current-event');
                    rows[currentEventIndex].classList.add('in-progress');
                }
                
                // 30 minutos despu√©s del inicio del evento, marcar como completado
                resetTimeout = setTimeout(() => {
                    messageEl.style.display = 'none';
                    isEventInProgress = false;
                    
                    // Marcar la sesi√≥n actual como completada
                    scheduleData[currentEventIndex].completed = true;
                    
                    // Actualizar estilos de la tabla
                    updateTableStyles();
                    
                    // Pasar a la siguiente sesi√≥n
                    currentEventIndex = scheduleData.findIndex(event => !event.completed);
                    
                    // Si es la √∫ltima sesi√≥n, mostrar mensaje final
                    if (currentEventIndex === -1) {
                        countdownContainer.style.display = 'none';
                        finalMessageEl.style.display = 'block';
                        return;
                    }
                    
                    // Reiniciar el contador para el siguiente evento
                    initCountdown();
                }, 1800000); // 30 minutos
            }
        }
        
        // (El resto del c√≥digo permanece igual)
    </script>
</body>
</html>
